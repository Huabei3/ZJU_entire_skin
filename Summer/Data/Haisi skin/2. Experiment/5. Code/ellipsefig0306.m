function [h,V,aa,bb,cc] = ellipsefig0306(xc,P,r,tag,i)
% »­Ò»°ãÍÖÔ²»òÍÖÇò£º(x-xc)'*P*(x-xc) = r
color=[220,0,10;220,150,0;0,220,10;0,10,220;
       220,0,10;220,150,0;0,220,10;0,10,220;0,0,0;
       220,0,10;220,150,0;0,220,10;0,10,220;
       220,0,10;220,150,0;0,220,10;0,10,220;0,0,0];
   q(1,:)=[1,1,5,1,10,5,5,5,2,2,1];
   q(2,:)=[4,4,1,10,2,1,1,1,10,10,1]; 
   
     line1=["-","-","-","-",":",":",":",":","-"];
%             "-.","-.","-.","-.","-.","-.","-.","-.","-.","-.","-"];
%      line1=["--","--","--","--","--","-","-","-","-","-","-",
%             "-.","-.","-.","-.","-.",":",":",":",":",":","-"];

[V, D] = eig(P); 
 tag == 1
     aa = sqrt(r/D(1));
     bb = sqrt(r/D(4));
%      aa = sqrt(r/D(1))*q(1,i);
%      bb = sqrt(r/D(4))*q(2,i);
     t = linspace(0, 2*pi, 60);
     xy = V*[aa*cos(t);bb*sin(t)];   % ×ø±êÐý×ª
     h = plot(xy(1,:)+xc(1),xy(2,:)+xc(2),line1(i),'Color',color(i,:)./255,'linewidth', 1);