%  clear all;
% load('Dfit_HS_D_1109.mat');
cct=[3000,4000,5000,6500,8000];
% % %================D80==================
% for i=1:5
% D1(1,i)=1;
% D1(2,i)=(1-1./3.6.*exp((-314.7-42)./92));
% D1(3,i)=0.723.*(1-1116./cct(i));
% D1(4,i)=0.726.*(1-2179./cct(i));
% D1(6,i)=0.237.*0.723.*(1-1116./cct(i));
% D1(7,i)=0.2934.*(1-2069./cct(i));
% D1(5,i)=0;
% end
% load('Dfit_HS_1109.mat');
% ct=[3000,4000,5000,6500,8000];
% 
% for j=1:7
% for i=1:5
% xyz=lab2xyz(lab(i,:),'user',[433.8 475.0 566.4]);
% f2=ciecat02_d(xyz,f1(i,:)./f1(i,2).*314.7,f1(5,:),'CAT16',100,100,D1(j,i)); 
% b1(i,:)=xyz2lab(f2,'user',[433.8 475.0 566.4]);
% de4(j,i)=cielabde(b1(i,:),lab(9,:))';
% end
% e(j,1)=MCDM(b1);
% end
% de80=abs(D1-D80);
% %================D65==================
for i=1:5
D1(1,i)=1;
D1(2,i)=(1-1./3.6.*exp((-314.7-42)./92));
D1(3,i)=0.723.*(1-1116./cct(i));
D1(4,i)=0.726.*(1-2179./cct(i));
D1(6,i)=0.239.*0.723.*(1-1116./cct(i));
D1(7,i)=0.2914.*(1-2084./cct(i));
D1(5,i)=0;
end
% de65=abs(D1-D65);
load('Dfit_HS_1109.mat');
ct=[3000,4000,5000,6500,8000];
for j=7
for i=1:5
xyz=lab2xyz(lab(i,:),'user',[433.8 475.0 566.4]);
f2=ciecat02_d(xyz,f1(i,:)./f1(i,2).*316.1,f1(4,:),'CAT16',100,100,D1(j,i)); 
b1(i,:)=xyz2lab(f2,'user',[433.8 475.0 566.4]);
de4(j,i)=cielabde(b1(i,:),lab(9,:))';
end
e(j,3)=MCDM(b1);
end
% % e(1)=MCDM(b1(1:5,:));e(2)=MCDM(b1(6:10,:));
% % e(3)=MCDM(b1(11:15,:));e(4)=MCDM(b1(16:20,:));
% % mean(e);


