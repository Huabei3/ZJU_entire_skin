%% caucasian
load CaucasianLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
z=M(3);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(300044297536657*x^2)/9007199254740992 - (4552568382262109*x*y)/576460752303423488 - (716285474390767505593810256477151*x)/162259276829213363391578010288128 + (5020990772876409*y^2)/36028797018963968 - (85743878447280717552016456699181*y)/20282409603651670423947251286016 + 1066870294214272177469741384426277436784764080463/5708990770823839524233143877797980545530986496
 
a=300044297536657/9007199254740992;
b=- 4552568382262109/576460752303423488;
c=5020990772876409/36028797018963968;
d= - 716285474390767505593810256477151/162259276829213363391578010288128;
e= - 85743878447280717552016456699181/20282409603651670423947251286016 ;
f=0.5-1066870294214272177469741384426277436784764080463/5708990770823839524233143877797980545530986496;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(2),M(1),'b.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% African
load AfricanLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
z=M(3);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(1359457739720861*x^2)/36028797018963968 + (351466256822563*x*y)/9007199254740992 - (9830475961396675448662245003635*x)/2535301200456458802993406410752 + (1217166899916971*y^2)/2251799813685248 - (3139148956835516616055411614665*y)/158456325028528675187087900672 + 44430209492808524376326925783500979722385430805/178405961588244985132285746181186892047843328
 
a=1359457739720861/36028797018963968 ;
b= 351466256822563/9007199254740992;
c= 1217166899916971/2251799813685248;
d= - 9830475961396675448662245003635/2535301200456458802993406410752  ;
e=- 3139148956835516616055411614665/158456325028528675187087900672;
f=0.5-44430209492808524376326925783500979722385430805/178405961588244985132285746181186892047843328;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(2),M(1),'k.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% SouthAsian
load SouthAsianLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
z=M(3);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5882074693997251*x^2)/144115188075855872 - (1133720121906859*x*y)/144115188075855872 - (95860294994099877668436922448865*x)/20282409603651670423947251286016 + (4765570071279637*y^2)/36028797018963968 - (20535592740852226755573044815587*y)/5070602400912917605986812821504 + 62548589122745027633207307419314006574426776743/356811923176489970264571492362373784095686656
 
a=5882074693997251/144115188075855872 ;
b=  - 1133720121906859/144115188075855872 ;
c=4765570071279637/36028797018963968 ;
d=  - 95860294994099877668436922448865/20282409603651670423947251286016  ;
e= - 20535592740852226755573044815587/5070602400912917605986812821504 ;
f=0.5-62548589122745027633207307419314006574426776743/356811923176489970264571492362373784095686656;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(2),M(1),'g.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% ChineseYY
load ChineseYYLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
z=M(3);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(1293810802857237*x^2)/36028797018963968 - (3332935560754607*x*y)/576460752303423488 - (750890192065333669341330895105097*x)/162259276829213363391578010288128 + (4918726205682851*y^2)/36028797018963968 - (174059450112075700411310558942553*y)/40564819207303340847894502572032 + 2157814414072282473807905991115535844498301103365/11417981541647679048466287755595961091061972992
 
a=1293810802857237/36028797018963968  ;
b= - 3332935560754607/576460752303423488 ;
c= 4918726205682851/36028797018963968;
d= - 750890192065333669341330895105097/162259276829213363391578010288128 ;
e= - 174059450112075700411310558942553/40564819207303340847894502572032;
f=0.5-2157814414072282473807905991115535844498301103365/11417981541647679048466287755595961091061972992;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(2),M(1),'r.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% ChineseYO
load ChineseYOLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
z=M(3);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5055293014472677*x^2)/144115188075855872 + (3575182972970505*x*y)/576460752303423488 - (760510546332240688470474551430789*x)/162259276829213363391578010288128 + (2866956593115455*y^2)/18014398509481984 - (59102490592764922582082311027185*y)/10141204801825835211973625643008 + 578555304103699247546046275293751303739270987423/2854495385411919762116571938898990272765493248
 
a=5055293014472677/144115188075855872 ;
b=  3575182972970505/576460752303423488;
c=2866956593115455/18014398509481984;
d=   -760510546332240688470474551430789/162259276829213363391578010288128  ;
e=- 59102490592764922582082311027185/10141204801825835211973625643008;
f=0.5-578555304103699247546046275293751303739270987423/2854495385411919762116571938898990272765493248;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(2),M(1),'y.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;
plot(C(2),C(1),'m-^','MarkerSize',10,'MarkerFaceColor','m');