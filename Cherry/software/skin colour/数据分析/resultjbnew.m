%% caucasian
load CaucasianLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
x=M(1);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(2570456098731591*y^2)/1125899906842624 - (4787410020357361*y*z)/4503599627370496 - (75337372310517532216507202433227*y)/1267650600228229401496703205376 + (2431064679664791*z^2)/1125899906842624 - (76738578500345424287067753879591*z)/1267650600228229401496703205376 + 380403782169861066061511286661071016474182146859/356811923176489970264571492362373784095686656
 
a=2570456098731591/1125899906842624 ;
b= - 4787410020357361/4503599627370496;
c= 2431064679664791/1125899906842624;
d= - 75337372310517532216507202433227/1267650600228229401496703205376 ;
e=- 76738578500345424287067753879591/1267650600228229401496703205376;
f=r-380403782169861066061511286661071016474182146859/356811923176489970264571492362373784095686656;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(2),M(3),'b.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% African
load AfricanLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
x=M(1);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(1217166899916971*y^2)/2251799813685248 + (7965309767396495*y*z)/2305843009213693952 - (11816885478075178377351186203851849*y)/649037107316853453566312041152512 + (1509618774433231*z^2)/9007199254740992 - (3957584719160249075620911391107707*z)/649037107316853453566312041152512 + 37948759488224179613471637202373402387508650676797/182687704666362864775460604089535377456991567872
 
a=1217166899916971/2251799813685248 ;
b= 7965309767396495/2305843009213693952;
c=1509618774433231/9007199254740992;
d= -11816885478075178377351186203851849/649037107316853453566312041152512  ;
e=- 3957584719160249075620911391107707/649037107316853453566312041152512;
f=0.5-37948759488224179613471637202373402387508650676797/182687704666362864775460604089535377456991567872;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(2),M(3),'k.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% SouthAsian
load SouthAsianLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
x=M(1);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(4765570071279637*y^2)/36028797018963968 - (7721180821906511*y*z)/288230376151711744 - (81973750028669596042171153991565*y)/20282409603651670423947251286016 + (4331387197498019*z^2)/72057594037927936 - (68228429124419062234410974943333*z)/40564819207303340847894502572032 + 141245395830692303084447194592793816956970126309/2854495385411919762116571938898990272765493248
 
a=4765570071279637/36028797018963968 ;
b=  -7721180821906511/288230376151711744  ;
c=4331387197498019/72057594037927936 ;
d=  - 81973750028669596042171153991565/20282409603651670423947251286016  ;
e=- 68228429124419062234410974943333/40564819207303340847894502572032;
f=0.5-141245395830692303084447194592793816956970126309/2854495385411919762116571938898990272765493248;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(2),M(3),'g.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% ChineseYY
load ChineseYYLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
x=M(1);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(4918726205682851*y^2)/36028797018963968 - (591230453083687*y*z)/18014398509481984 - (20712695538010706830448237807923*y)/5070602400912917605986812821504 + (5593746398386261*z^2)/72057594037927936 - (11222192002505840103653772245269*z)/5070602400912917605986812821504 + 156196800310610976580790132060043839915688553379/2854495385411919762116571938898990272765493248
 
a=4918726205682851/36028797018963968  ;
b=  - 591230453083687/18014398509481984  ;
c=5593746398386261/72057594037927936 ;
d=  - 20712695538010706830448237807923/5070602400912917605986812821504  ;
e=- 11222192002505840103653772245269/5070602400912917605986812821504;
f=0.5-156196800310610976580790132060043839915688553379/2854495385411919762116571938898990272765493248;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(2),M(3),'r.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% ChineseYO
load ChineseYOLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
x=M(1);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(2866956593115455*y^2)/18014398509481984 - (8976101554228977*y*z)/576460752303423488 - (208344761865698155593176074749195*y)/40564819207303340847894502572032 + (4905160156265555*z^2)/72057594037927936 - (363927703563840130625765341453171*z)/162259276829213363391578010288128 + 735465597251342204316299220310405969087283060455/11417981541647679048466287755595961091061972992
 
a=2866956593115455/18014398509481984 ;
b=  - 8976101554228977/576460752303423488   ;
c=4905160156265555/72057594037927936  ;
d=  - 208344761865698155593176074749195/40564819207303340847894502572032  ;
e=- 363927703563840130625765341453171/162259276829213363391578010288128;
f=0.5-735465597251342204316299220310405969087283060455/11417981541647679048466287755595961091061972992;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(2),M(3),'y.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;
plot(C(1),C(2),'m-^','MarkerSize',10,'MarkerFaceColor','m');