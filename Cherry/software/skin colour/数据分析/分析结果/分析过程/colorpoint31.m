% syms x;   %定义为符号变量 90%
syms y; 
syms z;
x=59;
x0 =59;
y0=18.7;
z0=19.6;
u0=0.00073397;
u1=0.000356861;
u2=0.0037019;
u3=0.000150894;
u4=-0.00248318;
u5=0.00196303;
ss = u0*(x-x0)^2+u1*(x-x0)*(y-y0)+u2*(y-y0)^2+u3*(x-x0)*(z-z0)+u4*(y-y0)*(z-z0)+u5*(z-z0)^2; %多项式公式
M=simplify(ss) %%简化多项式
J=expand(M);

(4268000117904087*y^2)/1152921504606846976 - (5725823243619261*y*z)/2305843009213693952 - (3234691769442003*y)/36028797018963968 + (2263219501188379*z^2)/1152921504606846976 - (703635142374887329*z)/23058430092136939520 + 131260099718074208881/115292150460684697600
a=4268000117904087/1152921504606846976;
b= -5725823243619261/2305843009213693952;
c= 2263219501188379/1152921504606846976;
d=-3234691769442003/36028797018963968;
e=-703635142374887329/23058430092136939520;
f=1-131260099718074208881/115292150460684697600;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;

q=0.5*atan(u4/(u5-u2))*180/pi;
angle=(90-q)*pi/180;
k=tan(angle);
b0=19.6-18.7*k;

syms y z
s=solve((4268000117904087*y^2)/1152921504606846976 - (5725823243619261*y*z)/2305843009213693952 - (3234691769442003*y)/36028797018963968 + (2263219501188379*z^2)/1152921504606846976 - (703635142374887329*z)/23058430092136939520 + 131260099718074208881/115292150460684697600==1,z==k*y+b0,y,z);
Y=double(s.y)
Z=double(s.z)
hold on;
plot(Y,Z,'r.','MarkerSize',20)


angle2=(180-q)*pi/180;
k2=tan(angle2);
b02=19.6-18.7*k2;

syms y z
s=solve((4268000117904087*y^2)/1152921504606846976 - (5725823243619261*y*z)/2305843009213693952 - (3234691769442003*y)/36028797018963968 + (2263219501188379*z^2)/1152921504606846976 - (703635142374887329*z)/23058430092136939520 + 131260099718074208881/115292150460684697600==1,z==k2*y+b02,y,z);
Y2=double(s.y)
Z2=double(s.z)
hold on;
plot(Y2,Z2,'b.','MarkerSize',20)

angle3=(127-q)*pi/180;
k3=tan(angle3);
b03=19.6-18.7*k3;

syms y z
s=solve((4268000117904087*y^2)/1152921504606846976 - (5725823243619261*y*z)/2305843009213693952 - (3234691769442003*y)/36028797018963968 + (2263219501188379*z^2)/1152921504606846976 - (703635142374887329*z)/23058430092136939520 + 131260099718074208881/115292150460684697600==1,z==k3*y+b03,y,z);
Y3=double(s.y)
Z3=double(s.z)
hold on;
plot(Y3,Z3,'g.','MarkerSize',20)

angle4=(233-q)*pi/180;
k4=tan(angle4);
b04=19.6-18.7*k4;

syms y z
s=solve((4268000117904087*y^2)/1152921504606846976 - (5725823243619261*y*z)/2305843009213693952 - (3234691769442003*y)/36028797018963968 + (2263219501188379*z^2)/1152921504606846976 - (703635142374887329*z)/23058430092136939520 + 131260099718074208881/115292150460684697600==1,z==k4*y+b04,y,z);
Y4=double(s.y)
Z4=double(s.z)
hold on;
plot(Y4,Z4,'y.','MarkerSize',20)


x=xyz(1,1:16);
y=xyz(2,1:16);
z=xyz(3,1:16);
x1=xyz(1,17:32);
y1=xyz(2,17:32);
z1=xyz(3,17:32);
x2=xyz(1,33:48);
y2=xyz(2,33:48);
z2=xyz(3,33:48);
x0=xyz(1,49);
y0=xyz(2,49);
z0=xyz(3,49);
scatter3(x,y,z,'r')
hold on
scatter3(x1,y1,z1,'g')
scatter3(x2,y2,z2,'b')
scatter3(x0,y0,z0,'k')
xlabel('a*','FontSize',13);
ylabel('b*','FontSize',13);
zlabel('L','FontSize',13);
axis equal;

h = ellipsefig1(a,b,c,d,e,f);
xlabel('a*','FontSize',13);
ylabel('b*','FontSize',13);
axis equal;
hold on;
axis([0,40,0,40]);
grid on;
for i=1:16
    plot(TargetLab(i,2),TargetLab(i,3),'b.','MarkerSize',15);
     text(TargetLab(i,2),TargetLab(i,3),{i},'FontSize',13);
    hold on;
end
  plot(TargetLab(49,2),TargetLab(49,3),'r.','MarkerSize',15);
 for i=9:10
    plot(YZ1(i,1),YZ1(i,2),'k-^','MarkerSize',5);
    text(YZ1(i,1),YZ1(i,2),{i},'FontSize',13);
    hold on;
 end
plot(YZ1(11,1),YZ1(11,2),'b.','MarkerSize',15);
plot(YZ1(12,1),YZ1(12,2),'r.','MarkerSize',15);
plot(YZ1(13,1),YZ1(13,2),'g.','MarkerSize',15);
plot(YZ1(14,1),YZ1(14,2),'k.','MarkerSize',15);
