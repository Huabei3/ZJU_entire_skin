%% GUF
load Caucasian50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:3,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
syms x; 
syms y;
S=V(1,1)*(x-M(1))^2+(V(1,2)+V(2,1))*(x-M(1))*(y-M(2))+V(2,2)*(y-M(2))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5247730420875697*x^2)/72057594037927936 - (2442327008330609*x*y)/72057594037927936 - (9373712984642594831598553105491*x)/5070602400912917605986812821504 + (3257852781575361*y^2)/72057594037927936 - (2702500145332740980898910480517*y)/2535301200456458802993406410752 + 9024357644947792320938646571628359114455315737/356811923176489970264571492362373784095686656
 
(42264272480347*x^2)/562949953421312 - (5567084443068345*x*y)/144115188075855872 - (18648484055872591921417607471051*x)/10141204801825835211973625643008 + (1597596270150401*y^2)/36028797018963968 - (1209778990510312747600778369735*y)/1267650600228229401496703205376 + 4317005360939955829948338895752441638761242573/178405961588244985132285746181186892047843328
 
a=42264272480347/562949953421312;
b= -5567084443068345/144115188075855872;
c=1597596270150401/36028797018963968;
d= -18648484055872591921417607471051/10141204801825835211973625643008;
e=-1209778990510312747600778369735/1267650600228229401496703205376;
f=0.5-4317005360939955829948338895752441638761242573/178405961588244985132285746181186892047843328;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(1),M(2),'b.','MarkerSize',25);

angle=0.5*atan(2*V(1,2)/(V(2,2)-V(1,1)))*180/pi;
%% GUM
load African50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:3,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
syms x; 
syms y;
S=V(1,1)*(x-M(1))^2+(V(1,2)+V(2,1))*(x-M(1))*(y-M(2))+V(2,2)*(y-M(2))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5588786316936723*x^2)/72057594037927936 - (1559676248456919*x*y)/36028797018963968 - (4660898837138243838090485487477*x)/2535301200456458802993406410752 + (6303456680105125*y^2)/144115188075855872 - (4328635082476814099646925495633*y)/5070602400912917605986812821504 + 16613957968065591707612526037830907909834041421/713623846352979940529142984724747568191373312
 
(5223048943120427*x^2)/72057594037927936 - (2895497662397967*x*y)/72057594037927936 - (34944472553534062812403364069295*x)/20282409603651670423947251286016 + (3293304489048987*y^2)/72057594037927936 - (19832083018449575237681238406845*y)/20282409603651670423947251286016 + 133769850658889920752717813092297709343094814825/5708990770823839524233143877797980545530986496
 
a=5223048943120427/72057594037927936;
b= -2895497662397967/72057594037927936;
c=3293304489048987/72057594037927936;
d= -34944472553534062812403364069295/20282409603651670423947251286016 ;
e= -19832083018449575237681238406845/20282409603651670423947251286016;
f=0.5-133769850658889920752717813092297709343094814825/5708990770823839524233143877797980545530986496;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
plot(M(1),M(2),'k.','MarkerSize',25);

angle=0.5*atan(2*V(1,2)/(V(2,2)-V(1,1)))*180/pi;
%% GUM
load BKFab
N=sum(BKF(1,:));
f=BKF(1,:)';
X=BKF(2:3,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=BKF(1,:);
F(2,:)=BKF(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
syms x; 
syms y;
S=V(1,1)*(x-M(1))^2+(V(1,2)+V(2,1))*(x-M(1))*(y-M(2))+V(2,2)*(y-M(2))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5588786316936723*x^2)/72057594037927936 - (1559676248456919*x*y)/36028797018963968 - (4660898837138243838090485487477*x)/2535301200456458802993406410752 + (6303456680105125*y^2)/144115188075855872 - (4328635082476814099646925495633*y)/5070602400912917605986812821504 + 16613957968065591707612526037830907909834041421/713623846352979940529142984724747568191373312
 
a=5588786316936723/72057594037927936;
b= -1559676248456919/36028797018963968;
c=6303456680105125/144115188075855872;
d= -4660898837138243838090485487477/2535301200456458802993406410752 ;
e= -4328635082476814099646925495633/5070602400912917605986812821504;
f=1-16613957968065591707612526037830907909834041421/713623846352979940529142984724747568191373312;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;