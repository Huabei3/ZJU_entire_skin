%% caucasian
load CaucasianLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
y=M(2);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(300044297536657*x^2)/9007199254740992 + (1678193188914203*x*z)/4611686018427387904 - (5913914577411057917755151829321457*x)/1298074214633706907132624082305024 + (4820559674391513*z^2)/72057594037927936 - (385777182223463836996000053328657*z)/162259276829213363391578010288128 + 8059204482962661692782751208106532208982139222539/45671926166590716193865151022383844364247891968
 
a=300044297536657/9007199254740992;
b=1678193188914203/4611686018427387904;
c=4820559674391513/72057594037927936;
d= - 5913914577411057917755151829321457/1298074214633706907132624082305024;
e= - 385777182223463836996000053328657/162259276829213363391578010288128;
f=0.5-8059204482962661692782751208106532208982139222539/45671926166590716193865151022383844364247891968;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('b*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(3),M(1),'b.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% African
load AfricanLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
y=M(2);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(1359457739720861*x^2)/36028797018963968 + (2709420679198061*x*z)/576460752303423488 - (536624294184916373967831020382235*x)/162259276829213363391578010288128 + (1509618774433231*z^2)/9007199254740992 - (126569333482935980328336162445525*z)/20282409603651670423947251286016 + 724078274113921065619721639466574823957106633595/5708990770823839524233143877797980545530986496
 
a=1359457739720861/36028797018963968 ;
b= 2709420679198061/576460752303423488;
c= 1509618774433231/9007199254740992;
d= - 536624294184916373967831020382235/162259276829213363391578010288128  ;
e=- 126569333482935980328336162445525/20282409603651670423947251286016;
f=0.5-724078274113921065619721639466574823957106633595/5708990770823839524233143877797980545530986496;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('b*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(3),M(1),'k.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% SouthAsian
load SouthAsianLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
y=M(2);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5882074693997251*x^2)/144115188075855872 - (3790677043144201*x*z)/288230376151711744 - (93838373647531999918330691000763*x)/20282409603651670423947251286016 + (4331387197498019*z^2)/72057594037927936 - (13755491536420221991089621778503*z)/10141204801825835211973625643008 + 106910762460527075667192753619510020387541046121/713623846352979940529142984724747568191373312
 
a=5882074693997251/144115188075855872 ;
b=  - 3790677043144201/288230376151711744  ;
c=4331387197498019/72057594037927936 ;
d=  - 93838373647531999918330691000763/20282409603651670423947251286016  ;
e=- 13755491536420221991089621778503/10141204801825835211973625643008;
f=0.5-106910762460527075667192753619510020387541046121/713623846352979940529142984724747568191373312;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('b*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(3),M(1),'g.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% ChineseYY
load ChineseYYLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
y=M(2);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(1293810802857237*x^2)/36028797018963968 - (4981715482228323*x*z)/576460752303423488 - (92735058574238253150479218807161*x)/20282409603651670423947251286016 + (5593746398386261*z^2)/72057594037927936 - (89484108806954922398834181972141*z)/40564819207303340847894502572032 + 242864753553208498722186224358284525113685359569/1427247692705959881058285969449495136382746624
 
a=1293810802857237/36028797018963968   ;
b=  - 4981715482228323/576460752303423488  ;
c= 5593746398386261/72057594037927936 ;
d= - 92735058574238253150479218807161/20282409603651670423947251286016 ;
e=- 89484108806954922398834181972141/40564819207303340847894502572032;
f=0.5-242864753553208498722186224358284525113685359569/1427247692705959881058285969449495136382746624;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('b*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(3),M(1),'r.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;

%% ChineseYO
load ChineseYOLab50
N=sum(result(1,:));
f=result(1,:)';
X=result(2:4,:);
M=(mean(X'))';
u=X*f/N*ones(1,size(f,1));
F(1,:)=result(1,:);
F(2,:)=result(1,:);
F(3,:)=result(1,:);
vv= F.*(X-u)*(X-u)' /N;
V=vv^(-1);
u0=V(1,1);
u1=V(1,2)+V(2,1);
u2=V(2,2);
u3=V(1,3)+V(3,1);
u4=V(2,3)+V(3,2);
u5=V(3,3);
syms x; 
syms y;
syms z;
y=M(2);
S=u0*(x-M(1))^2+u1*(x-M(1))*(y-M(2))+u2*(y-M(2))^2+...
    u3*(x-M(1))*(z-M(3))+u4*(y-M(2))*(z-M(3))+u5*(z-M(3))^2;
S0=simplify(S); %%简化多项式
J=expand(S0)
(5055293014472677*x^2)/144115188075855872 - (3584694210572093*x*z)/2305843009213693952 - (738718202866896539196890984361119*x)/162259276829213363391578010288128 + (4905160156265555*z^2)/72057594037927936 - (97625300999151776524834022420263*z)/40564819207303340847894502572032 + 487601137090612928100199953877528403406285811003/2854495385411919762116571938898990272765493248
 
a=5055293014472677/144115188075855872 ;
b=  - 3584694210572093/2305843009213693952   ;
c=4905160156265555/72057594037927936 ;
d=   - 738718202866896539196890984361119/162259276829213363391578010288128  ;
e=- 97625300999151776524834022420263/40564819207303340847894502572032;
f=0.5-487601137090612928100199953877528403406285811003/2854495385411919762116571938898990272765493248;
h = ellipsefig1(a,b,c,d,e,f);
axis equal;
hold on;
xlabel('b*','FontSize',15);
ylabel('L*','FontSize',15);
axis equal;
plot(M(3),M(1),'y.','MarkerSize',25);

q=0.5*atan(u4/(u5-u2))*180/pi;
plot(C(2),C(1),'m-^','MarkerSize',10,'MarkerFaceColor','m');