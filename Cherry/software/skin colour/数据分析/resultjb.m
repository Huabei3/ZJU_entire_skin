% load result_Caucasian
% L=result(:,1);
% a=result(:,2);
% b=result(:,3);
% P=result(:,4);
% p0 = [1 1 1 1 1 1 1 1 1 1];  
% X=[L,a,b];
% [p,r,j] = nlinfit(X,P,@pengrui,p0);
% y = pengrui(p, X);
% plot(P,y,'o');
% pr=corrcoef(P,y);
% mse=mean((P-y).^2);

load Caucasian50
X=result;
[ center, radii, evecs, v, chi2 ] = ellipsoid_fit( X);
x=center(1);
y=center(2);
z=center(3);
XX= evecs^-1;
u0=XX(1,1);
u1=XX(1,2)+XX(2,1);
u2=XX(2,2);
u3=XX(1,3)+XX(3,1);
u4=XX(2,3)+XX(3,2);
u5=XX(3,3);
syms y; 
syms z;
x=center(1);
x0 =center(1);
y0=center(2);
z0=center(3);
ss = u0*(x-x0)^2+u1*(x-x0)*(y-y0)+u2*(y-y0)^2+u3*(x-x0)*(z-z0)+u4*(y-y0)*(z-z0)+u5*(z-z0)^2; %多项式公式
M=simplify(ss); %%简化多项式
J=expand(M)
(8536556712763937*y^2)/2305843009213693952 - (1431777547848037*y*z)/576460752303423488 - (13229035601018951966133983597951*y)/162259276829213363391578010288128 + (565851172945641*z^2)/288230376151711744 - (1989903262744825429251255200449*z)/81129638414606681695789005144064 + 40368695044869318786056489666125142592789065073/45671926166590716193865151022383844364247891968
 
a=8536556712763937/2305843009213693952;
b= -1431777547848037/576460752303423488;
c=565851172945641/288230376151711744;
d=-13229035601018951966133983597951/162259276829213363391578010288128;
e=-1989903262744825429251255200449/81129638414606681695789005144064;
f=0.5-40368695044869318786056489666125142592789065073/45671926166590716193865151022383844364247891968;
h = ellipsefig1(a,b,c,d,e,f);
xlabel('a*','FontSize',15);
ylabel('b*','FontSize',15);
axis equal;
hold on;
for i=1:16
    plot(result(i,2),result(i,3),'r.','MarkerSize',10);
   
    hold on;
end
 plot(center(2),center(3),'b.','MarkerSize',20);
